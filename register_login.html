<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task28 Elite - Access</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body {
            background: radial-gradient(circle at center, #1a1a1a 0%, #000 100%);
            font-family: 'Segoe UI', sans-serif; color: #fff;
            display: flex; justify-content: center; align-items: center;
            min-height: 100vh; margin: 0;
        }
        .glass-card {
            width: 90%; max-width: 400px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(15px);
            padding: 30px; border-radius: 20px;
            border: 1px solid rgba(255, 215, 0, 0.2);
            box-shadow: 0 0 40px rgba(0,0,0,0.8);
        }
        .title { text-align: center; font-size: 2rem; font-weight: 800; color: #ffd700; margin-bottom: 20px; letter-spacing: 2px; }
        .tabs { display: flex; margin-bottom: 25px; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .tab { flex: 1; text-align: center; padding: 12px; cursor: pointer; color: #888; transition: 0.3s; font-weight: bold; }
        .tab.active { color: #ffd700; border-bottom: 2px solid #ffd700; }
        
        .input-group { position: relative; margin-bottom: 15px; }
        .input-group i { position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: #ffd700; }
        input {
            width: 100%; padding: 12px 12px 12px 40px;
            background: rgba(0,0,0,0.5); border: 1px solid #333;
            color: #fff; border-radius: 8px; outline: none; box-sizing: border-box;
        }
        input:focus { border-color: #ffd700; }
        
        .btn-main {
            width: 100%; padding: 14px; margin-top: 10px;
            background: linear-gradient(45deg, #ffd700, #b8860b);
            border: none; border-radius: 8px; color: #000; font-weight: bold;
            font-size: 1rem; cursor: pointer; transition: 0.3s;
        }
        .btn-main:active { transform: scale(0.98); }
        .hidden { display: none; }
        #msg { text-align: center; margin-top: 15px; font-size: 0.9rem; min-height: 20px; }
    </style>
</head>
<body>

<div class="glass-card">
    <div class="title">TASK28</div>
    <div class="tabs">
        <div class="tab active" onclick="switchTab('login')">LOGIN</div>
        <div class="tab" onclick="switchTab('register')">REGISTER</div>
    </div>

    <!-- Login -->
    <div id="loginForm">
        <div class="input-group"><i class="fas fa-phone"></i><input type="number" id="lPhone" placeholder="Phone Number"></div>
        <div class="input-group"><i class="fas fa-lock"></i><input type="password" id="lPass" placeholder="Password"></div>
        <button class="btn-main" onclick="handleLogin()">LOGIN</button>
    </div>

    <!-- Register -->
    <div id="regForm" class="hidden">
        <div class="input-group"><i class="fas fa-user"></i><input type="text" id="rFname" placeholder="First Name"></div>
        <div class="input-group"><i class="fas fa-user"></i><input type="text" id="rLname" placeholder="Last Name"></div>
        <div class="input-group"><i class="fas fa-phone"></i><input type="number" id="rPhone" placeholder="Phone Number"></div>
        <div class="input-group"><i class="fas fa-lock"></i><input type="password" id="rPass" placeholder="Password"></div>
        <div class="input-group"><i class="fas fa-lock"></i><input type="password" id="rConf" placeholder="Confirm Password"></div>
        <div class="input-group"><i class="fas fa-code"></i><input type="text" id="rRef" placeholder="Referral Code (Optional)"></div>
        <button class="btn-main" onclick="handleRegister()">CREATE ACCOUNT</button>
    </div>
    
    <div id="msg"></div>
</div>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyCXMFqxIe8IrZkzUx2YVMTvVXQmIAhtruc",
        authDomain: "love-1-6cdb1.firebaseapp.com",
        databaseURL: "https://love-1-6cdb1-default-rtdb.firebaseio.com",
        projectId: "love-1-6cdb1",
        storageBucket: "love-1-6cdb1.firebasestorage.app",
        messagingSenderId: "949848083048",
        appId: "1:949848083048:web:ced52526264da1dcf4c9dd"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.database();

    function showMsg(text, color) {
        const m = document.getElementById('msg');
        m.style.color = color; m.innerText = text;
    }

    function switchTab(t) {
        document.getElementById('msg').innerText = "";
        if(t==='login'){
            document.getElementById('loginForm').classList.remove('hidden');
            document.getElementById('regForm').classList.add('hidden');
            document.querySelectorAll('.tab')[0].classList.add('active');
            document.querySelectorAll('.tab')[1].classList.remove('active');
        } else {
            document.getElementById('loginForm').classList.add('hidden');
            document.getElementById('regForm').classList.remove('hidden');
            document.querySelectorAll('.tab')[0].classList.remove('active');
            document.querySelectorAll('.tab')[1].classList.add('active');
        }
    }

    function handleRegister() {
        const fname = document.getElementById('rFname').value;
        const lname = document.getElementById('rLname').value;
        const phone = document.getElementById('rPhone').value;
        const pass = document.getElementById('rPass').value;
        const conf = document.getElementById('rConf').value;
        const ref = document.getElementById('rRef').value || "ADMIN";

        if(!fname || !lname || !phone || !pass) return showMsg("All fields required!", "red");
        if(pass !== conf) return showMsg("Passwords do not match!", "red");
        if(phone.length < 11) return showMsg("Invalid Phone Number!", "red");

        showMsg("Creating Account...", "#ffd700");
        const email = phone + "@task28.com";

        auth.createUserWithEmailAndPassword(email, pass)
            .then((cred) => {
                const uid = cred.user.uid;
                db.ref('users/' + uid).set({
                    firstName: fname, lastName: lname, phone: phone,
                    password: pass, referralCode: ref,
                    myReferralCode: "REF" + Math.floor(100000 + Math.random() * 900000),
                    balance: 0, lifetimeBalance: 0, totalReferrals: 0, todayReferrals: 0,
                    tasksCompleted: 0, accountActive: false, joinDate: new Date().toISOString()
                }).then(() => { window.location.href = "home.html"; });
            })
            .catch((e) => showMsg(e.message, "red"));
    }

    function handleLogin() {
        const phone = document.getElementById('lPhone').value;
        const pass = document.getElementById('lPass').value;
        if(!phone || !pass) return showMsg("Enter Phone & Password", "red");
        
        showMsg("Logging in...", "#ffd700");
        auth.signInWithEmailAndPassword(phone + "@task28.com", pass)
            .then(() => window.location.href = "home.html")
            .catch(() => showMsg("Invalid Credentials or Network Error", "red"));
    }

    auth.onAuthStateChanged(user => { if(user) window.location.href = "home.html"; });
</script>
</body>
</html>
